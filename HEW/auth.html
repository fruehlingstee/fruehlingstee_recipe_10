<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ログイン/登録 - レシピサイト2026</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<nav>
    <a href="index.html" style="font-size:1.5rem; text-decoration:none;"><img src="images/C'est trop bon logo.png" alt="" style="width: 80px;"></a>
    <div class="nav-links">
        <a href="renkin.html">食材錬金</a>
        <a href="roulette.html">食材ルーレット</a>
        <a href="ranking.html">ランキング</a>
        <a href="mypage.html">マイページ</a>
        <a href="auth.html">ログイン</a>
    </div>
</nav>
    <div class="auth-wrap">
    <div class="auth-card">
        <div class="tabs">
            <div class="tab active" onclick="switchTab('login')">ログイン</div>
            <div class="tab" onclick="switchTab('signup')">新規登録</div>
        </div>
        <form id="authForm">
            <div class="form-group">
                <label>メールアドレス</label>
                <input type="email" placeholder="example@mail.com" required>
            </div>
            <div class="form-group">
                <label>パスワード</label>
                <input type="password" placeholder="••••••••" required>
            </div>
            <button type="submit" class="btn-auth" id="submitBtn">ログイン</button>
        </form>
        <div class="social-login">
            または SNSアカウントでログイン
        </div>

    </div>
    </div>
    <script type="module">
  import { auth } from "./js/firebase.js";
  import {
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  // タブ切り替え（既存のままでOK）
  let currentMode = "login";
  window.switchTab = function(mode) {
    currentMode = mode;
    document.querySelectorAll(".tab").forEach(tab => {
      tab.classList.remove("active");
    });
    document.querySelectorAll(".tab").forEach(tab => {
      if(tab.innerText.includes(mode === "login" ? "ログイン" : "新規登録")){
        tab.classList.add("active");
      }
    });
    document.getElementById("submitBtn").innerText =
      mode === "signup" ? "登録" : "ログイン";
  };

  // フォーム送信
  document.getElementById("authForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const email = this.querySelector("input[type='email']").value;
    const pass  = this.querySelector("input[type='password']").value;

    try {
      if(currentMode === "signup") {
        // 新規登録
        await createUserWithEmailAndPassword(auth, email, pass);
        alert("登録完了！");
      } else {
        // ログイン
        await signInWithEmailAndPassword(auth, email, pass);
        alert("ログイン成功！");
      }
      location.href = "mypage.html";

    } catch(err) {
      // エラーの種類によってメッセージを出し分ける
      if(err.code === "auth/email-already-in-use") {
        alert("このメールはすでに登録されています");
      } else if(err.code === "auth/wrong-password" || err.code === "auth/user-not-found") {
        alert("メールまたはパスワードが違います");
      } else if(err.code === "auth/weak-password") {
        alert("パスワードは6文字以上にしてください");
      } else {
        alert("エラー：" + err.message);
      }
    }
  });
</script>
</body>
</html>

